#  ____________________________________
# / This file is managed by Chef. Your \
# \ changes will be overwritten.       /
#  ------------------------------------
#         \   ^__^
#          \  (oo)\_______
#             (__)\       )\/\
#                 ||----w |
#                 ||     ||

<% escaped_cluster = @cluster.gsub("'", "\\'")
   escaped_prefix = @prefix.gsub("'", "\\'")
   escaped_version = @version.gsub("'", "\\'") -%>

data_directory = '<%= escaped_prefix %>/var/lib/postgresql/<%= escaped_version %>/<%= escaped_cluster %>'
hba_file = '<%= escaped_prefix %>/etc/postgresql/<%= escaped_version %>/<%= escaped_cluster %>/pg_hba.conf'
ident_file = '<%= escaped_prefix %>/etc/postgresql/<%= escaped_version %>/<%= escaped_cluster %>/pg_ident.conf'
external_pid_file = '<%= escaped_prefix %>/var/run/postgresql/<%= escaped_version %>-<%= escaped_cluster %>.pid'

#-----------------------------------------------------------------------------------------------------------------------
# CONNECTIONS AND AUTHENTICATION
#-----------------------------------------------------------------------------------------------------------------------

# - Connection Settings -

port = 5432
max_connections = 100
unix_socket_directory = '<%= escaped_prefix %>/var/run/postgresql'

# - Security and Authentication -

ssl = true

#-----------------------------------------------------------------------------------------------------------------------
# RESOURCE USAGE (except WAL)
#-----------------------------------------------------------------------------------------------------------------------

# - Memory -

shared_buffers = <%= @cache_size / 2 %>MB

#-----------------------------------------------------------------------------------------------------------------------
# WRITE AHEAD LOG
#-----------------------------------------------------------------------------------------------------------------------

#-----------------------------------------------------------------------------------------------------------------------
# REPLICATION
#-----------------------------------------------------------------------------------------------------------------------

#-----------------------------------------------------------------------------------------------------------------------
# QUERY TUNING
#-----------------------------------------------------------------------------------------------------------------------

# - Planner Cost Constants -

effective_cache_size = <%= @cache_size %>MB

#-----------------------------------------------------------------------------------------------------------------------
# ERROR REPORTING AND LOGGING
#-----------------------------------------------------------------------------------------------------------------------

# - What to Log -

log_line_prefix = '%t ' # special values:
                    #   %a = application name
                    #   %u = user name
                    #   %d = database name
                    #   %r = remote host and port
                    #   %h = remote host
                    #   %p = process ID
                    #   %t = timestamp without milliseconds
                    #   %m = timestamp with milliseconds
                    #   %i = command tag
                    #   %e = SQL state
                    #   %c = session ID
                    #   %l = session line number
                    #   %s = session start timestamp
                    #   %v = virtual transaction ID
                    #   %x = transaction ID (0 if none)
                    #   %q = stop here in non-session
                    #        processes
                    #   %% = '%'
                    # e.g. '<%%u%%%d> '

#-----------------------------------------------------------------------------------------------------------------------
# RUNTIME STATISTICS
#-----------------------------------------------------------------------------------------------------------------------

#-----------------------------------------------------------------------------------------------------------------------
# AUTOVACUUM PARAMETERS
#-----------------------------------------------------------------------------------------------------------------------

#-----------------------------------------------------------------------------------------------------------------------
# CLIENT CONNECTION DEFAULTS
#-----------------------------------------------------------------------------------------------------------------------

# - Locale and Formatting -

datestyle = 'iso, mdy'

lc_messages = 'en_US.UTF-8'                         # locale for system error message strings
lc_monetary = 'en_US.UTF-8'                         # locale for monetary formatting
lc_numeric = 'en_US.UTF-8'                          # locale for number formatting
lc_time = 'en_US.UTF-8'                             # locale for time formatting
default_text_search_config = 'pg_catalog.english'   # default configuration for text search

#-----------------------------------------------------------------------------------------------------------------------
# LOCK MANAGEMENT
#-----------------------------------------------------------------------------------------------------------------------

#-----------------------------------------------------------------------------------------------------------------------
# VERSION/PLATFORM COMPATIBILITY
#-----------------------------------------------------------------------------------------------------------------------

#-----------------------------------------------------------------------------------------------------------------------
# ERROR HANDLING
#-----------------------------------------------------------------------------------------------------------------------

#-----------------------------------------------------------------------------------------------------------------------
# CUSTOMIZED OPTIONS
#-----------------------------------------------------------------------------------------------------------------------
